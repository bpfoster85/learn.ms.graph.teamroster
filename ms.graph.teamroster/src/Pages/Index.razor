@page "/"

@inject IHttpClientFactory HttpClientFactory
@inject Microsoft.Identity.Web.ITokenAcquisition TokenAcquisitionService

Welcome to your new Microsoft Field Team Roster App.


@code {
    private string userDisplayName;


    private HttpClient _httpClient;

    protected override async Task OnInitializedAsync()
    {
        _httpClient = HttpClientFactory.CreateClient();


        // get a token
        var token = await TokenAcquisitionService.GetAccessTokenForUserAsync(new string[] { "User.Read", "Mail.Read" });

        //// make API call
        //_httpClient.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("Bearer", token);
        //var dataRequest = await _httpClient.GetAsync("https://graph.microsoft.com/beta/me");

        //if (dataRequest.IsSuccessStatusCode)
        //{
        //    var userData = System.Text.Json.JsonDocument.Parse(await dataRequest.Content.ReadAsStreamAsync());
        //    userDisplayName = userData.RootElement.GetProperty("displayName").GetString();
        //}

        //var mailRequest = await _httpClient.GetAsync("https://graph.microsoft.com/beta/me/messages?$select=subject,receivedDateTime,sender&$top=10");
    }
}